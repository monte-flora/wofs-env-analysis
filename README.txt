=== Warn-on-Forecast System Summary Files ===

Contributors: Montgomery Flora (monte.flora@noaa.gov), Brian Matilla, and Patrick Skinner 
Created : Fall 2021 
Generated using the WoF_post github repo (https://github.com/WarnOnForecast/WoF_post) 

The summary files were generated using the following scripts:
(all located in /home/monte.flora/projects/summary_file_reprocessing)
1. summary_file_reprocessing.py for the ENS, ENV, and SVR files
2. wofs_discrete_swaths.py for 30M and 60M
3. wofs_continuous_swaths.py for SWT files
4. (Brian Matilla's sounding script) 

The configuration files for the different years (2017-2021) 
are availabed in /home/monte.flora/projects/summary_file_reprocessing/conf. 

If you have questions about this dataset, please reach out to 
Montgomery Flora (monte.flora@noaa.gov) 

=== Description ===

The Warn-on-Forecast System (WoFS) summary files are the compressed, 
post-processed version of the WRFOUTs generated by the WoFS. These 
files are used to generate the graphics for the real-time web viewer 
(https://wof.nssl.noaa.gov/realtime/) and are used for verification
and machine learning model development. The summary files should 
be CF-complaint and contain metadata for plotting. 

The following file format is used for the summary files: 

file = /work/mflora/SummaryFiles/20170509/0300/wofs_ENS_02_20170510_0300_0310.nc 
                                |-------|-----|   |---|----|--------|----|----|
                                  date   init    summary  |  valid    init valid
                                         time   file type |  date     time time
                                                          |
                                                          time index 
date              : The initial date the WoFS run started on. 
init time         : The initialization time of the forecast (typically every 30 min between 18-03, but can vary) 
summary file type : See below 
time index        : Time step index (0-72 for most cases; 72 5-min outputs for a 6-hr forecast)
                    For the 30M and 60M files, indexing starts at 6 rather than 0 
valid date        : Valid date for the file (will change after inititalization time occurs during the next day; after 0000) 
init time         : see above 
valid time        : Valid time for the file 


There are currently 7 summary file types (ENS, ENV, SVR, SND, SWT, 30M, 60M). The post-processing 
separated the diagnostic variables into different intermediate files
for a quicker I/O.  Variables in each summary file are provided below. 
Some variables (e.g., fed) are included in more than one summary file, but 
they are identical and again is designed for efficient I/O.

Eventually, there will be additionally summary files that contain the inputs 
into the WoFS-ML-Severe guidance (Flora et al. MWR, 2021) 

 
***Disclaimer***: Some variables are not available for all years (2017-2021). 
Please refer to the config files (/home/monte.flora/projects/summary_file_reprocessing/conf)
and/or performing ncdump -c to see the exact variables available in a given summary file.

=== Changes from year to year ====

This section provides information on changes to the WoFS between 2017-current. 
If summary files are incomplete or missing that should be documented here.


2017 : 
       1) Forecasts initialized on the half hour only go to 3 hrs and not 6 hrs.
       2) Switched to the NSSL 2-moment microphysics package 
       3) Boundary conditions only went out to 0555 so the last timestep of 6 hr forecasts are missing. 

       Missing/Partially complete::20170601  20170602  20170605  20170606  20170607  20170608 

2018 : 

2019 : 
      1) "fed" and "chg_sep" were added to the WRFOUTs
      2) Time-integrated 0-2 UH is added to the WRFOUTs (prior to this 
         there is only instanteous low-level UH) 

    Missing/Partially complete::

2020 : 

    Missing/Partially complete::

2021 : 

    Missing/Partially complete::

    1) 20210603 had unresolvable issues in realtime, but was rerun for
       completeness. 



=== Brief Description of Variables Available in the Variour Summary Files ====

1. ENS : intra-storm variables 

    'uh_2to5_instant'  : Instatenous 2-5 km AGL Updraft Helicity (m^2/s^2)
    'uh_0to2_instant'  : Instatenous 0-2 km AGL Updraft Helicity (m^2/s^2)
    'wz_0to2_instant'  : Instatenous 0-2 km AGL Avg. Vertical Vorticity (s^-1)
    'comp_dz'          : Composite Reflectivity (dBZ)
    'rain'             : Accumulated Rainfall (in.)
    'ws_80'            : 80-m wind speed (kts)
    'hail'             : Max hail size at the surface (NSSL 2-moment; in)
    'hailcast'         : Max hail size at the surface (Hailcast; in)
    'dbz_1km'          : 1-km AGL Reflectivity (dBZ)
    'dbz_2km'          : 2-km AGL Reflectivity (dBZ)
    'wz_0to2'          : Time-integrated 0-2 km AGL Avg. Vertical Vorticity (s^-1)
    'uh_0to2'          : Time-integrated 0-2 km AGL Updraft Helicity (m^2/s^2)
    'uh_2to5'          : Time-integrated 2-5 km AGL Updraft Helicity (m^2/s^2)
    'w_up'             : Column-maximum updraft speed (m/s^-1)
    'dbz_3to5'         : 3-5 km AGL Maximum Reflectivity (dBZ)
    'w_1km'            : 0-1 km maximum updraft speed (m/s^-1)
    'w_down'           : Column-minimum updraft speed (m/s^-1)
    'buoyancy'         : Near-surface Buoyancy Deficit (unitless)
    'div_10m'          : 10-m AGL Divergence (s^-1)
    '10-500m_bulkshear': 10-500 m AGL Bulk Shear (kts)
    'ctt'              : Cloud top temperature (deg F)
    'fed'              : Flash Extent Density (flashes/ km^2)
    'chg_sep'          : Charge Separation Rate (C m^-2 s^-1)
    'dbz_1to3'         : 1-3 km AGL Maximum Reflectivity (dBZ)
    'rh_avg'           : Layer-Averaged Relative Humidity (unitless)
    'okubo_weiss'      : Okubo-Weiss Parameter (unitless)
    'freezing_level'   : Height of freezing level (m) 

2.  ENV : environmental 
    "mslp"                 : Mean Sea-Level Pressure (hPa)
    "u_10"                 : 10-m U-component of Wind (kts)
    "v_10"                 : 10-m V-component of Wind (kts)
    "td_2"                 : 2-m Dewpoint Temperature (deg F)
    "t_2"                  : 2-m Temperature (deg F)
    "qv_2"                 : 2-m Water Vapor (Kg/Kg)
    "theta_e"              : Equivalent Potential Temperature (K)
    "u_850_300p"           : U-component of 850-300 hPa wind
    "v_850_300p"           : V-component of 850-300 hPa wind
    "omega"                : 700-hPa omega (vertical velocity)
    "sw_down"              : Downward flux of shortwave radiation at the ground
    "iwp"                  : Cloud ice water path
    "lwp"                  : Cloud liquid water path
    "pw"                   : Precipitable Water 
    "ctp"                  : Cloud Top Pressure
    "psfc"                 : Surface Pressure
    "pbl_mfc"              : Boundary-layer moisture convergence 
    'fed'                  : Flash Extent Density (flashes/ km^2)
    'chg_sep'              : Charge Separation Rate (C m^-2 s^-1)
    'mid_level_lapse_rate' : 700-500 mb Temperature Lapse Rate
    'low_level_lapse_rate' : 0-3 km AGL Temperature Lapse Rate 
    
    There are also variables for different pressure levels
    temperature_{850, 500, 700}  : Temperature at 850, 500, or 700-hpa level
    td_{850, 500, 700}           : Dewpoint Temperature at 850, 500, or 700-hpa level
    geo_hgt_{850, 500, 700}      : Geopotential Height at 850, 500, or 700-hpa level
    QVAPOR_{850, 500, 700}       : Water Vapor at 850, 500, or 700-hpa level
    U_{850, 500, 700}            : U-wind component at 850, 500, or 700-hpa level
    V_{850, 500, 700}            : V-wind component at 850, 500, or 700-hpa level
    
3. SVR : sounding-based 
    "bunk_r_u" : U-component of Bunkers right-mover storm motion
    "bunk_r_v" : V-component of Bunkers right-mover storm motion    
        
    "shear_u_0to1" : 0-1 km U-Wind Shear 
    "shear_v_0to1" : 0-1 km V-Wind Shear
    "shear_u_0to3" : 0-3 km U-Wind Shear 
    "shear_v_0to3" : 0-3 km V-Wind Shear 
    "shear_u_0to6" : 0-6 km U-Wind Shear 
    "shear_v_0to6" : 0-6 km V-Wind Shear 
    "shear_u_3to6" : 3-6 km U-Wind Shear
    "shear_v_3to6" : 3-6 km V-Wind Shear
    "srh_0to500"   : 0-500 m storm relative helicity
    "srh_0to1"     : 0-1 km storm relative helicity
    "srh_0to3"     : 0-3 km storm relative helicity
    "corf_us_u"    : U-component of Corfidi upshear vector 
    "corf_us_v"    : V-component of Corfidi upshear vector     
    "corf_ds_u"    : U-component of Corfidi downshear vector 
    "corf_ds_v"    : V-component of Corfidi downshear vector
    "stp"          : Significant Tornado Parameter
    'scp'          : Supercell Composite Parameter
    "stp_srh0to500" : Significant tornado parameter w/0-500 m SRH
    
    
    The following variables are available in multiple layers. 
    The layer include lowest 100 mb mixed layer (ml), most unstable (mu), 
    and surface-based (sfc)
    
    cape_{ml, mu, sfc} : Convective Available Potential Energy    
    cin_{ml, mu, sfc} : Convection Inhibition 
    lcl_{ml, mu, sfc} : Lifting Condensation Level     
    lfc_{ml, mu, sfc} : Level of Free Convection 

4. SND : coarsen-resolution with vertical components 
	float u(NE, NZ, NY, NX) ;
		u:long_name = "U-component of wind" ;
		u:units = "m s**-1" ;
	float v(NE, NZ, NY, NX) ;
		v:long_name = "V-component of wind" ;
		v:units = "m s**-1" ;
	float p(NE, NZ, NY, NX) ;
		p:long_name = "Pressure" ;
		p:units = "hPa" ;
	float t(NE, NZ, NY, NX) ;
		t:long_name = "Temperature" ;
		t:units = "C" ;
	float q(NE, NZ, NY, NX) ;
		q:long_name = "Water vapor mixing ratio" ;
		q:units = "Kg/Kg" ;
	float z_agl(NE, NZ, NY, NX) ;
		z_agl:long_name = "Height above ground level" ;
		z_agl:units = "m" ;
	float omega(NE, NZ, NY, NX) ;
		omega:long_name = "Pressure vertical velocity" ;
		omega:units = "Pa s**-1" ;

5-6. 30M and 60M : discrete swaths used for object identification 
    Time-maximum values over a 30- or 60-min period. 

    "comp_dz"
    "rain"
    "ws_80"
    "hail"
    "hailcast"
    "wz_0to2"
    "uh_0to2"
    "uh_2to5"
    "w_up"
    "fed"

7.  SWT: continuous swaths 
    


















